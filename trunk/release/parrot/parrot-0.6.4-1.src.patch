diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/MANIFEST src/parrot-0.6.4/MANIFEST
--- origsrc/parrot-0.6.4/MANIFEST	2008-07-15 09:58:46.000000000 +0000
+++ src/parrot-0.6.4/MANIFEST	2008-07-19 08:46:17.562500000 +0000
@@ -7,10 +7,10 @@
 # format of this file.
 # See docs/submissions.pod on how to recreate this file after SVN
 # has been told about new or deleted files.
-CREDITS                                                     []
-ChangeLog                                                   []
+CREDITS                                                     [devel]doc
+ChangeLog                                                   [devel]doc
 Configure.pl                                                []
-DEPRECATED.pod                                              []
+DEPRECATED.pod                                              [devel]doc
 DONORS.pod                                                  []
 LICENSE                                                     [main]doc
 MANIFEST                                                    []
@@ -22,11 +22,11 @@
 PBC_COMPAT                                                  [devel]doc
 PLATFORMS                                                   [devel]doc
 README                                                      [devel]doc
-README_cygwin.pod                                           []
-README_win32.pod                                            []
+README_cygwin.pod                                           [devel]doc
+README_win32.pod                                            [devel]doc
 RESPONSIBLE_PARTIES                                         [main]doc
 TODO                                                        [main]doc
-VERSION                                                     []
+VERSION                                                     [devel]doc
 apps/p3/README                                              [apps/p3]
 apps/p3/cgi-pir/slides.pir                                  [apps/p3]
 apps/p3/index.html                                          [apps/p3]
@@ -3077,7 +3077,7 @@
 src/pbc_disassemble.c                                       []
 src/pbc_info.c                                              []
 src/pbc_merge.c                                             []
-src/pdb.c                                                   []
+src/parrot_debugger.c                                       []
 src/pdump.c                                                 []
 src/pic.c                                                   []
 src/pic_jit.c                                               []
@@ -3866,7 +3866,7 @@
 t/tools/ops2pmutils/10-print_module.t                       []
 t/tools/ops2pmutils/11-print_h.t                            []
 t/tools/pbc_merge.t                                         []
-t/tools/pdb.t                                               []
+t/tools/parrot_debugger.t                                   []
 t/tools/pmc2c.t                                             []
 t/tools/pmc2cutils/00-qualify.t                             []
 t/tools/pmc2cutils/01-pmc2cutils.t                          []
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/README_cygwin.pod src/parrot-0.6.4/README_cygwin.pod
--- origsrc/parrot-0.6.4/README_cygwin.pod	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/README_cygwin.pod	2008-07-19 08:18:54.593750000 +0000
@@ -6,37 +6,98 @@
 
 =head1 SYNOPSIS
 
-Parrot builds out of the box under Cygwin.  Some tweaks are needed for
-different names of dynamic loading of some dll's.
+Parrot builds out of the box under Cygwin after 
+C<export PATH=`pwd`/blib/lib:$PATH>
+
+There are official cygwin parrot packages available via
+L<http://cygwin.com/setup.exe>.
+
+  parrot libparrot0 libparrot-devel parrot-perl6 parrot-languages
+
+Some tweaks are needed for different names for the ffi to some dll's.
+See L</loadlib DLL versioning>
+
 
 =head1 Packages
 
-You'll need the following Cygwin packages to build Parrot.
+You'll need the following Cygwin packages to run and build Parrot 
+by your own.
 
-=over 4
+Runtime requirements:
+
+  libreadline6 ncurses libintl8 libgmp3 libgdbm4
+
+Optional requirements:
+
+  libicu38 libpq5 openssl
+
+  for opengl: w32api opengl or libglut3 xorg-x11-base xorg-x11-bin-dlls
+
+Build requirements:
+
+  gcc make perl parrot readline libncurses-devel libgmp-devel
+  libgdbm-devel pcre-devel 
+
+Optional build requirements:
+
+  libicu-devel openssl-devel 
+
+  for Cygwin/X opengl: freeglut xorg-x11-devel 
+
+Optional perl packages for testing: 
+
+  L<Test::TAP::HTMLMatrix> if you want to run the language smoke tests
+  with C<make languages-smoke>.
 
-=item gcc
+  L<Test::Base> for some APL language tests.
 
-=item make
+  perl L<Moose> for smartlink
 
-=item perl
+  perl L<Test::Perl::Critic> and L<Perl::Critic>
 
-=item subversion
+=over 4
+
+=item Cygwin subversion and perl
 
 If you use SVN to get a copy of Parrot, you should use the Cygwin SVN
 and not the TortoiseSVN client to avoid build errors.  Similarly you will
 need Cygwin Perl rather than ActiveState or Strawberry Perl.
 
-=item ICU
-
-This is no official Cygwin package yet.  However, icu4c-3_8 builds out of the
-box on Cygwin.
-
-  http://download.icu-project.org/files/icu4c/3.8/icu4c-3_8-src.tgz
+=item icu
 
 Note that ICU is now optional, you can build Parrot without it,
 by not installing it or asking Parrot to ignore it (C<--without-icu>).
 
+=item opengl
+
+You can use the w32api and opengl packages for native Windows opengl support,
+or the freeglut package for the X Server.
+
+Configure.pl will detect freeglut if freeglut is installed and DISPLAY 
+is set, otherwise it checks for w32api and opengl with GLUT.
+
+  Determining if your platform supports OpenGL.............yes, freeglut 3.4.
+  Determining if your platform supports OpenGL...................yes, GLUT 3.
+  Determining if your platform supports OpenGL............................no.
+
+Required packages:
+
+  w32api
+
+or 
+
+  freeglut xorg-x11-devel xorg-x11-base xorg-x11-bin-dlls
+
+=item SDL
+
+SDL references F<cygSDL-1-2-0.dll>, which is only in cygports
+L<http://news.gmane.org/gmane.os.cygwin.ports.announce>
+
+=item aio
+
+libaio-devel "Linux-native asynchronous I/O access" is not available
+for cygwin, and as the name says it will never be :)
+
 =back
 
 =head1 BUILD
@@ -53,21 +114,24 @@
 
 =item Makefile tuning
 
-rename libparrot.dll to cygparrot.dll, create an interim libparrot.dll.a
+Rename libparrot.dll to cygparrot0_6_x.dll and create an interim libparrot.dll.a
 
-fix the blib/lib PATH issue
+  [perl #56998] [TODO]  rename cygwin dll to cygparrot$MAJOR_$MINOR_$PATCH.dll
+  [perl #56562] [PATCH] root.in: add cygwin importlib
 
-=item DLL versioning
+=item loadlib DLL versioning
 
-cyg*-1.1.dll instead of lib*.so.1.1
+Use cyg*-1.1.dll naming conventions instead of lib*.so.1.1 names for loadlib, the
+FFI.
 
-Thanks to the L<Windows DLL Hell / http://> and the impossibility of file
+Thanks to the L<Windows DLL Hell / http://?> and the impossibility of file
 hardlinks, windows dll names are versioned, so the loadlib function or the
 various pir's needs more logic.
 
 Either add the version to each loadlib call, and stem the version from POSIX
 versions within get_path(), or add an optional version argument to loadlib for
-win32. Or just fix all the pir's.
+win32. Or just fix all the pir's, which will be easier when exceptions work 
+again.
 
 =item Features
 
@@ -89,6 +153,6 @@
 
 =head1 HISTORY
 
-Last updated: 1 June 2008
+Last updated: 15 July 2008
 
 =cut
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/gcc.pm src/parrot-0.6.4/config/auto/gcc.pm
--- origsrc/parrot-0.6.4/config/auto/gcc.pm	2008-02-23 18:27:32.000000000 +0000
+++ src/parrot-0.6.4/config/auto/gcc.pm	2008-07-19 08:18:54.593750000 +0000
@@ -86,6 +86,7 @@
     print " (yep: $gccversion )" if $verbose;
     $self->set_result('yes');
 
+    # Don't worry about too many redundant warnings in this list.
     my $ccwarn = $conf->data->get('ccwarn');
 
     $conf->data->set( sym_export => '__attribute__ ((visibility("default")))' )
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in src/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in
--- origsrc/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in	2008-03-16 09:53:34.000000000 +0000
+++ src/parrot-0.6.4/config/auto/jit/test_exec_cygwin.in	2008-07-19 08:18:54.609375000 +0000
@@ -5,6 +5,7 @@
 #include <errno.h>
 #include <malloc.h>
 #include <unistd.h>
+#include <string.h>
 #ifndef PAGE_SIZE
 #  define PAGE_SIZE getpagesize()
 #endif
@@ -40,7 +41,7 @@
     if (atoi(argv[1]))
         prot |= PROT_EXEC;
 
-    p = memalign(PAGE_SIZE, sizeof(code));
+    p = memalign(PAGE_SIZE, PAGE_SIZE);
     memcpy(p, code, sizeof(code));
 
     t  = (pf) p;
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/opengl.pm src/parrot-0.6.4/config/auto/opengl.pm
--- origsrc/parrot-0.6.4/config/auto/opengl.pm	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/config/auto/opengl.pm	2008-07-19 08:18:54.609375000 +0000
@@ -109,11 +109,16 @@
 
  XXXX: No details yet
 
+=head3 Cygwin/w32api
 
-=head3 cygwin
+F<opengl>, F<w32api>
 
- XXXX: No details yet
+=head3 Cygwin/X
+
+F<freeglut>, F<xorg-x11-devel>
 
+This is detected if freeglut is installed and DISPLAY is set.
+It requires an X server.
 
 =cut
 
@@ -163,6 +168,11 @@
         conf            => $conf,
         osname          => $osname,
         cc              => $cc,
+        # Prefer Cygwin/w32api over Cygwin/X, but use X when DISPLAY is set
+        ($^O eq 'cygwin') ?
+         ($ENV{DISPLAY} ? (cygwin => '-lglut -L/usr/X11R6/lib -lGLU -lGL')
+                        : (cygwin => '/usr/bin/glut32.dll -lglu32 -lopengl32')) 
+         : (),
         win32_gcc       => '-lglut32 -lglu32 -lopengl32',
         win32_nongcc    => 'opengl32.lib glu32.lib glut32.lib',
         darwin          => '-framework OpenGL -framework GLUT',
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/auto/warnings.pm src/parrot-0.6.4/config/auto/warnings.pm
--- origsrc/parrot-0.6.4/config/auto/warnings.pm	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/config/auto/warnings.pm	2008-07-19 08:18:54.609375000 +0000
@@ -11,6 +11,8 @@
 -Wchar-subscripts, etc., that the compiler can support.  Directly hacked
 from F<config/auto/attributes.pm>.
 
+Don't worry about redundant warning flags, automatically implied by -Wall.
+
 =head1 SUBROUTINES
 
 =over 4
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/gen/makefiles/root.in src/parrot-0.6.4/config/gen/makefiles/root.in
--- origsrc/parrot-0.6.4/config/gen/makefiles/root.in	2008-07-15 07:50:15.000000000 +0000
+++ src/parrot-0.6.4/config/gen/makefiles/root.in	2008-07-19 08:18:54.609375000 +0000
@@ -467,7 +467,7 @@
 PDUMP               = $(CUR_DIR)/pdump$(EXE)
 PINFO               = $(CUR_DIR)/pbc_info$(EXE)
 PBCMERGE            = $(CUR_DIR)/pbc_merge$(EXE)
-PDB                 = $(CUR_DIR)/pdb$(EXE)
+PDB                 = $(CUR_DIR)/parrot_debugger$(EXE)
 PBC_TO_EXE          = $(CUR_DIR)/pbc_to_exe$(EXE)
 PARROT_CONFIG       = $(CUR_DIR)/parrot-config$(EXE)
 
@@ -480,7 +480,7 @@
 INSTALLABLEPDUMP    = $(CUR_DIR)/installable_pdump$(EXE)
 INSTALLABLEPINFO    = $(CUR_DIR)/installable_pbc_info$(EXE)
 INSTALLABLEPBCMERGE = $(CUR_DIR)/installable_pbc_merge$(EXE)
-INSTALLABLEPDB      = $(CUR_DIR)/installable_pdb$(EXE)
+INSTALLABLEPDB      = $(CUR_DIR)/installable_parrot_debugger$(EXE)
 
 # Libraries
 LIBPARROT_STATIC    = @blib_dir@/@libparrot_static@
@@ -773,8 +773,8 @@
     lib/Parrot/OpLib/core.pm $(SRC_DIR)/parrot_config$(O) \
     $(MINIPARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/main$(O) @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS) $(LINK_DYNAMIC) \
-    $(SRC_DIR)/parrot_config$(O)
+    $(SRC_DIR)/main$(O) @rpath_blib@ $(LINKFLAGS) $(LINK_DYNAMIC) \
+    $(SRC_DIR)/parrot_config$(O) $(ALL_PARROT_LIBS)
 
 pbc_to_exe.pir : $(PARROT) tools/dev/pbc_to_exe_gen.pl
 	$(PERL) tools/dev/pbc_to_exe_gen.pl \
@@ -801,15 +801,15 @@
 # TODO build the real miniparrot
 $(MINIPARROT) : $(SRC_DIR)/main$(O) $(GEN_HEADERS) $(LIBPARROT) \
     lib/Parrot/OpLib/core.pm $(SRC_DIR)/null_config$(O)
-	$(LINK) @ld_out@$@ $(SRC_DIR)/main$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS) $(SRC_DIR)/null_config$(O)
+	$(LINK) @ld_out@$@ $(SRC_DIR)/main$(O) $(SRC_DIR)/null_config$(O) \
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(INSTALLABLEPARROT) : $(SRC_DIR)/main$(O) $(GEN_HEADERS) $(LIBPARROT) \
     lib/Parrot/OpLib/core.pm $(SRC_DIR)/install_config$(O) \
     $(PARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/main$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS) $(SRC_DIR)/install_config$(O)
+    $(SRC_DIR)/main$(O) $(SRC_DIR)/install_config$(O) \
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(INC_DIR)/parrot.h : $(INC_DIR)/pbcversion.h $(INC_DIR)/vtable.h
 
@@ -878,7 +878,8 @@
 $(LIBPARROT_SHARED) : $(O_FILES)
 	$(MKPATH) @blib_dir@
 	$(LD) $(LD_SHARE_FLAGS) $(LDFLAGS) @ld_out@$@ @libparrot_soname@ \
-    $(O_FILES) $(C_LIBS) $(ICU_SHARED)
+#CONDITIONED_LINE(cygchkdll):		-Wl,--out-implib=blib/lib/libparrot.dll.a \
+		$(O_FILES) $(C_LIBS) $(ICU_SHARED)
 #CONDITIONED_LINE(libparrot_shared_alias):	( cd @blib_dir@ ; ln -sf @libparrot_shared@ @libparrot_shared_alias@ )
 
 
@@ -886,17 +887,17 @@
 # Parrot Debugger
 #
 
-$(SRC_DIR)/pdb$(O) : $(GENERAL_H_FILES)
+$(SRC_DIR)/parrot_debugger$(O) : $(GENERAL_H_FILES)
 
-$(PDB) : $(SRC_DIR)/pdb$(O) $(LIBPARROT)
+$(PDB) : $(SRC_DIR)/parrot_debugger$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/pdb$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/parrot_debugger$(O) \
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
-$(INSTALLABLEPDB) : $(SRC_DIR)/pdb$(O) $(LIBPARROT)
+$(INSTALLABLEPDB) : $(SRC_DIR)/parrot_debugger$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
-    $(SRC_DIR)/pdb$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/parrot_debugger$(O) \
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 #
 # Parrot Disassembler
@@ -907,12 +908,12 @@
 $(DIS) : $(SRC_DIR)/pbc_disassemble$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_disassemble$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(INSTALLABLEDIS) : $(SRC_DIR)/pbc_disassemble$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_disassemble$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 #
 # Parrot Dump
@@ -921,28 +922,28 @@
 $(PDUMP) : $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pdump$(O) \
-    $(SRC_DIR)/packdump$(O) @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/packdump$(O) @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(SRC_DIR)/pdump$(O) : $(GEN_HEADERS)
 
 $(INSTALLABLEPDUMP) : $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pdump$(O) \
-    $(SRC_DIR)/packdump$(O) $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(SRC_DIR)/packdump$(O) $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 
 # pbc_info
 $(PINFO) : $(SRC_DIR)/pbc_info$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_info$(O) \
-    @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 $(SRC_DIR)/pbc_info$(O) : $(GEN_HEADERS)
 
 $(INSTALLABLEPINFO) : $(SRC_DIR)/pbc_info$(O) $(LIBPARROT)
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_info$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 #
 # Parrot Bytecode File Merger
@@ -959,7 +960,7 @@
 	$(LINK) @ld_out@$@ \
     $(SRC_DIR)/pbc_merge$(O) \
     $(SRC_DIR)/install_config$(O) \
-    $(ALL_PARROT_LIBS) $(LINKFLAGS)
+    $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 
 ###############################################################################
@@ -1606,7 +1607,7 @@
     $(IMCC_DIR)/main$(O) \
     $(PDUMP) $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) \
     $(SRC_DIR)/pbc_info$(O) $(PINFO) \
-    $(PDB) $(SRC_DIR)/pdb$(O) \
+    $(PDB) $(SRC_DIR)/parrot_debugger$(O) \
     $(PBCMERGE) $(SRC_DIR)/pbc_merge$(O) \
     $(DIS) $(SRC_DIR)/pbc_disassemble$(O) \
     $(SRC_DIR)/main$(O) \
@@ -1642,7 +1643,7 @@
     $(IMCC_DIR)/main$(O) \
     $(PDUMP) $(SRC_DIR)/pdump$(O) $(SRC_DIR)/packdump$(O) \
     $(SRC_DIR)/pbc_info$(O) $(PINFO) \
-    $(PDB) $(SRC_DIR)/pdb$(O) \
+    $(PDB) $(SRC_DIR)/parrot_debugger$(O) \
     $(PBCMERGE) $(SRC_DIR)/pbc_merge$(O) \
     $(DIS) $(SRC_DIR)/pbc_disassemble$(O) \
     $(SRC_DIR)/null_config$(O) \
@@ -1720,7 +1721,7 @@
 	$(RM_F) \
      "t/tools/pmc2c.t_*" \
      "t/tools/pmc2c.pmc_t_*" \
-     "t/tools/pdb.t.*"
+     "t/tools/parrot_debugger.t.*"
 	$(RM_F) \
      "test$(EXE)" \
      "test.*"
@@ -2164,7 +2165,7 @@
 ###############################################################################
 
 exec : $(SRC_DIR)/exec_start$(O) $(SRC_DIR)/parrot_config$(O) $(LIBPARROT)
-	$(LINK) @ld_out@$(EXEC)$(EXE) $(EXEC)$(O) $(SRC_DIR)/exec_start$(O) $(SRC_DIR)/parrot_config$(O) @rpath_blib@ $(ALL_PARROT_LIBS) $(LINKFLAGS)
+	$(LINK) @ld_out@$(EXEC)$(EXE) $(EXEC)$(O) $(SRC_DIR)/exec_start$(O) $(SRC_DIR)/parrot_config$(O) @rpath_blib@ $(LINKFLAGS) $(ALL_PARROT_LIBS)
 
 ###### OS depend targets ##########
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/init/hints/cygwin.pm src/parrot-0.6.4/config/init/hints/cygwin.pm
--- origsrc/parrot-0.6.4/config/init/hints/cygwin.pm	2008-06-02 17:35:05.000000000 +0000
+++ src/parrot-0.6.4/config/init/hints/cygwin.pm	2008-07-19 08:18:54.609375000 +0000
@@ -13,18 +13,30 @@
     # in the standard installation, so we get rid of it
     my $libs = $conf->data->get('libs');
     $libs =~ s/-lutil\b//g;
+    # same for -lm and -dl
+    $libs =~ s/-lm\b//g;
+    $libs =~ s/-ldl\b//g;
 
     my $build_dir = $conf->data->get('build_dir');
     $build_dir =~ s/ /\\ /g;
+    my $libparrot_shared = $conf->data->get('libparrot_shared');
+    # force cyg prefix
+    $libparrot_shared =~ s/^lib/cyg/g;
+    # force the dll versioning
+    my @parrot_version = Parrot::BuildUtil::parrot_version();
+    my $dllsuffix = join("_",@parrot_version);
+    $libparrot_shared =~ s/parrot\.dll/parrot$dllsuffix\.dll/;
 
-    # A note about building shared libraries:  Perl5 uses the 'ld2' tool, which
-    # is installed as part of the perl5 installation.  So far, it appears
-    # parrot can get by with simply using gcc -shared, so we override the
-    # perl5 Configure defaults and use 'gcc -shared' instead of 'ld2'.
+    # An old note about building shared libraries: Perl5.8 used the
+    # 'ld2' tool, which is installed as part of the perl5 installation.
+    # So far, it appears parrot can get by with simply using gcc -shared,
+    # so we override the perl5 Configure defaults and use 'gcc -shared'
+    # instead of 'ld2'.
     # If this later causes problems, it might be worth revisiting.
     # A. Dougherty 9/9/2002
     $conf->data->set(
         build_dir           => $build_dir,
+	libparrot_shared    => $libparrot_shared,
         ld                  => 'gcc',
         ld_share_flags      => '-shared',
         ld_load_flags       => '-shared',
@@ -37,6 +49,7 @@
         cygchkdll           => 'tools/build/cygchkdll.sh $(MINIPARROT) $(LIBPARROT)',
     );
 
+
     # inet_aton needs to be defined on Cygwin.
     my $define = $conf->options->get('define');
     unless ($define) {
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/config/inter/libparrot.pm src/parrot-0.6.4/config/inter/libparrot.pm
--- origsrc/parrot-0.6.4/config/inter/libparrot.pm	2008-05-11 13:27:01.000000000 +0000
+++ src/parrot-0.6.4/config/inter/libparrot.pm	2008-07-19 08:18:54.625000000 +0000
@@ -46,6 +46,8 @@
     # of the shared parrot library. However, 'libparrot.so' will catch
     # at least some of the problems.
     # RT#52288: the check for old_versions should be improved
+    # The cygwin build with a preexisting libparrot.dll in the PATH
+    # works fine if blib/lib is in the PATH before.
     my $old_version
         = File::Spec->catfile($conf->data->get('libdir'), 'libparrot.so');
     if (-e $old_version) {
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/docs/debug.pod src/parrot-0.6.4/docs/debug.pod
--- origsrc/parrot-0.6.4/docs/debug.pod	2008-02-23 18:27:15.000000000 +0000
+++ src/parrot-0.6.4/docs/debug.pod	2008-07-19 08:18:54.625000000 +0000
@@ -75,10 +75,10 @@
 Let's say you have written (or generated) a huge .pasm or .pir file.  It's not
 working. You'd like some help in figuring out why.
 
-=head2 pdb
+=head2 parrot_debugger
 
-One possible tool is C<pdb>, the Parrot Debugger. See F<docs/debugger.pod> for
-details on it.
+One possible tool is C<parrot_debugger>, the Parrot Debugger. See
+F<docs/debugger.pod> for details on it.
 
 =head2 stabs
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/docs/debugger.pod src/parrot-0.6.4/docs/debugger.pod
--- origsrc/parrot-0.6.4/docs/debugger.pod	2008-02-23 18:27:15.000000000 +0000
+++ src/parrot-0.6.4/docs/debugger.pod	2008-07-19 08:18:54.625000000 +0000
@@ -7,20 +7,20 @@
 
 =head1 ABSTRACT
 
-This document describes F<pdb>, the Parrot Debugger.
+This document describes F<parrot_debugger>, the Parrot Debugger.
 
 =head1 DESCRIPTION
 
 Starting from version 0.0.6 Parrot has its own debugger, which is modeled after
-Perl's one. Its name is F<pdb>, and is an interactive environment that let you
-step through bytecode, set breakpoints, evaluate assembly instructions and peek
-at the interpreter status.
+Perl's one. Its name is F<parrot_debugger>, and is an interactive environment
+that let you step through bytecode, set breakpoints, evaluate assembly
+instructions and peek at the interpreter status.
 
 A good (well, at least some) knowledge of the Parrot internals is obviously
 required to read this document. Some familiarity with debugging principles is
 also mandatory beyond this point.
 
-=head1 BUILDING pdb
+=head1 BUILDING parrot_debugger
 
 The debugger is not built with Parrot, but you should make it with its specific
 target:
@@ -29,18 +29,18 @@
 
 (where C<make> is the same C<make> incarnation you used to build Parrot).
 
-If everything goes well, you should come up with a F<pdb> executable in the
-same directory as the Parrot program.
+If everything goes well, you should come up with a F<parrot_debugger> executable
+in the same directory as the Parrot program.
 
 =head1 THE DEBUGGER SHELL
 
 To start the debugger type:
 
-  pdb file.pbc
+  parrot_debugger file.pbc
 
-That is, F<pdb> takes exactly one argument, which is the Parrot bytecode that
-you're going to debug. F<pdb> will automatically load and disassemble the
-bytecode file for you.
+That is, F<parrot_debugger> takes exactly one argument, which is the Parrot
+bytecode that you're going to debug. F<parrot_debugger> will automatically load
+and disassemble the bytecode file for you.
 
 Note that you can't pass command line arguments to your program when you invoke
 the debugger. See the C<run (r)> command below for this.
@@ -49,8 +49,8 @@
 
   (pdb)
 
-F<pdb> is ready to receive commands and give output. To list the available
-commands type 'h'. To quit the debugger type 'q'.
+F<parrot_debugger> is ready to receive commands and give output. To list the
+available commands type 'h'. To quit the debugger type 'q'.
 
 As with the Perl debugger, whenever it halts and shows you a line of code, it
 is always the line it's I<about> to execute, not the one that it has just
@@ -69,10 +69,10 @@
 
 A blank line always repeats the last command entered.
 
-Also note that at this point in its development, F<pdb> has very poor error
-checking on commands and their arguments, so type carefully or something bad
-will happen. Feel free to report bugs, or better yet patch the source code (see
-L</FILES> below).
+Also note that at this point in its development, F<parrot_debugger> has very
+poor error checking on commands and their arguments, so type carefully or
+something bad will happen. Feel free to report bugs, or better yet patch the
+source code (see L</FILES> below).
 
 =over 4
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/docs/parrot.pod src/parrot-0.6.4/docs/parrot.pod
--- origsrc/parrot-0.6.4/docs/parrot.pod	2008-02-23 18:27:15.000000000 +0000
+++ src/parrot-0.6.4/docs/parrot.pod	2008-07-19 08:18:54.625000000 +0000
@@ -112,7 +112,7 @@
 
 =item F<debugger.pod>
 
-Documentation for C<pdb>, the Parrot debugger.
+Documentation for C<parrot_debugger>, the Parrot debugger.
 
 =back
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/editor/parrot.el src/parrot-0.6.4/editor/parrot.el
--- origsrc/parrot-0.6.4/editor/parrot.el	2008-02-26 18:33:25.000000000 +0000
+++ src/parrot-0.6.4/editor/parrot.el	2008-07-19 09:06:55.781250000 +0000
@@ -8,7 +8,7 @@
 ;; To use this file, copy it to a known location and add this statement to
 ;; your .emacs file:
 ;;
-;;   (load-file "/known/location/parrot.el")
+;;   (load-file "/usr/share/emacs/site-lisp/parrot.el")
 ;;
 
 (c-add-style "parrot"
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/languages/urm/urmc src/parrot-0.6.4/languages/urm/urmc
--- origsrc/parrot-0.6.4/languages/urm/urmc	2008-02-23 18:27:38.000000000 +0000
+++ src/parrot-0.6.4/languages/urm/urmc	2008-07-19 09:44:38.781250000 +0000
@@ -18,7 +18,7 @@
 
 use strict;
 use FindBin;
-use lib "$FindBin::RealBin/../../lib";
+use lib "$FindBin::Bin/../../lib";
 
 use Data::Dumper;
 use Getopt::Long;
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/lib/Parrot/Config.pm src/parrot-0.6.4/lib/Parrot/Config.pm
--- origsrc/parrot-0.6.4/lib/Parrot/Config.pm	2008-02-23 18:27:18.000000000 +0000
+++ src/parrot-0.6.4/lib/Parrot/Config.pm	2008-07-19 08:18:54.625000000 +0000
@@ -19,7 +19,7 @@
 use strict;
 use warnings;
 
-eval 'use Parrot::Config::Generated';
+eval 'require Parrot::Config::Generated';
 if ($@) {
     die "\nParrot::Config is unavailable until you configure parrot.\n"
         . "Please run `perl Configure.pl`.\n\n";
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm src/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm
--- origsrc/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm	2008-06-24 19:59:15.000000000 +0000
+++ src/parrot-0.6.4/lib/Parrot/Configure/Step/Methods.pm	2008-07-19 08:18:54.625000000 +0000
@@ -119,6 +119,7 @@
         cc              => $cc,
         win32_gcc       => '-lalpha32 -lalpha32 -lopenalpha32',
         win32_nongcc    => 'alpha.lib',
+        cygwin          => '-lalpha32 -lXalpha32', # optional
         darwin          => 'alphadarwin.lib',
         default         => '-lalpha',
     } );
@@ -134,10 +135,12 @@
 
 =over 4
 
-=item * MSWin32 with F<gcc> as the C-compiler.
+=item * MSWin32 with F<gcc> as the C-compiler - Mingw.
 
 =item * MSWin32 with any C-compiler other than F<gcc>.
 
+=item * Cygwin to override Mingw.
+
 =item * Darwin.
 
 =back
@@ -173,7 +176,7 @@
 
 =item * C<win32_gcc>
 
-Libraries to be added where OS is mswin32 and C-compiler is F<gcc>.
+Libraries to be added where OS is mswin32 or cygwin and C-compiler is F<gcc>.
 Single whitespace-delimited string.
 
 =item * C<win32_nongcc>
@@ -181,6 +184,12 @@
 Libraries to be added where OS is mswin32 and C-compiler is not F<gcc>.
 Single whitespace-delimited string.
 
+=item * C<cygwin>
+
+Optional libraries to be added where OS is cygwin. This overrides C<win32_gcc>
+if defined.
+Single whitespace-delimited string.
+
 =item * C<darwin>
 
 Libraries to be added where OS is Darwin.  Do not supply a value if the value
@@ -197,7 +206,8 @@
     my $args = shift;
     croak "_add_to_libs() takes hashref: $!" unless ref($args) eq 'HASH';
     my $platform =
-          (($args->{osname} =~ /mswin32/i ||
+           $args->{osname} =~ /cygwin/i      ? 'cygwin'
+        :(($args->{osname} =~ /mswin32/i ||
            $args->{osname} =~ /cygwin/i) &&
            $args->{cc} =~ /^gcc/i)          ? 'win32_gcc'
         :  $args->{osname} =~ /mswin32/i    ? 'win32_nongcc'
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/runtime/parrot/library/ncurses.pir src/parrot-0.6.4/runtime/parrot/library/ncurses.pir
--- origsrc/parrot-0.6.4/runtime/parrot/library/ncurses.pir	2008-02-23 18:27:07.000000000 +0000
+++ src/parrot-0.6.4/runtime/parrot/library/ncurses.pir	2008-07-19 09:25:05.609375000 +0000
@@ -1,6 +1,9 @@
 .sub __ncurses_init :load
 
 loadlib $P1, 'libform'
+if $P1 goto has_lib
+loadlib $P1, 'cygform-8'
+has_lib:
 dlfunc $P2, $P1, 'new_field', 'piiiiii'
 store_global 'ncurses::new_field', $P2
 dlfunc $P2, $P1, 'dup_field', 'ppii'
@@ -119,7 +122,9 @@
 store_global 'ncurses::data_behind', $P2
 
 loadlib $P1, 'libncurses'
-
+if $P1 goto has_lib1
+loadlib $P1, 'cygncurses-8'
+has_lib1:
 dlfunc $P2, $P1, 'keybound', 'tii'
 store_global 'ncurses::keybound', $P2
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/runtime/parrot/library/postgres.pir src/parrot-0.6.4/runtime/parrot/library/postgres.pir
--- origsrc/parrot-0.6.4/runtime/parrot/library/postgres.pir	2008-03-16 09:53:34.000000000 +0000
+++ src/parrot-0.6.4/runtime/parrot/library/postgres.pir	2008-07-19 09:18:52.906250000 +0000
@@ -5,6 +5,8 @@
 if $P1 goto has_lib
 loadlib $P1, 'pq'
 if $P1 goto has_lib
+loadlib $P1, 'cygpq'
+if $P1 goto has_lib
 $P2 = new 'Exception'
 $P2[0] = 'error loading libpg - loadlib failed'
 throw $P2
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/src/parrot_debugger.c src/parrot-0.6.4/src/parrot_debugger.c
--- origsrc/parrot-0.6.4/src/parrot_debugger.c	1970-01-01 00:00:00.000000000 +0000
+++ src/parrot-0.6.4/src/parrot_debugger.c	2008-07-19 08:18:54.625000000 +0000
@@ -0,0 +1,304 @@
+/*
+Copyright (C) 2001-2008, The Perl Foundation.
+$Id: parrot_debugger.c 28973 2008-07-02 21:28:26Z chromatic $
+
+=head1 NAME
+
+parrot_debugger - The Parrot debugger
+
+=head1 SYNOPSIS
+
+ parrot_debugger programfile
+
+=head1 DESCRIPTION
+
+=head2 Commands
+
+=over 4
+
+=item C<disassemble>
+
+Disassemble the bytecode.
+
+Use this if you have a PBC file but not the PASM.
+
+=item C<load>
+
+Load a source code file.
+
+=item C<list> or C<l>
+
+List the source code file.
+
+=item C<run> or C<r>
+
+Run the program.
+
+=item C<break> or C<b>
+
+Add a breakpoint.
+
+=item C<watch> or C<w>
+
+Add a watchpoint.
+
+=item C<delete> or C<d>
+
+Delete a breakpoint.
+
+=item C<disable>
+
+Disable a breakpoint.
+
+=item C<enable>
+
+Reenable a disabled breakpoint.
+
+=item C<continue> or C<c>
+
+Continue the program execution.
+
+=item C<next> or C<n>
+
+Run the next instruction
+
+=item C<eval> or C<e>
+
+Run an instruction.
+
+=item C<trace> or C<t>
+
+Trace the next instruction.
+
+=item C<print> or C<p>
+
+Print the interpreter registers.
+
+=item C<stack> or C<s>
+
+Examine the stack.
+
+=item C<info>
+
+Print interpreter information.
+
+=item C<quit> or C<q>
+
+Exit the debugger.
+
+=item C<help> or C<h>
+
+Print the help.
+
+=back
+
+=head2 Debug Ops
+
+You can also debug Parrot code by using the C<debug_init>, C<debug_load>
+and C<debug_break> ops in F<ops/debug.ops>.
+
+=over 4
+
+=cut
+
+*/
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <ctype.h>
+#include "../compilers/imcc/imc.h"
+#include "../compilers/imcc/parser.h"
+#include "parrot/embed.h"
+
+static void PDB_printwelcome(void);
+static void PDB_run_code(Parrot_Interp interp, int argc, char *argv[]);
+
+/*
+
+=item C<int main(int argc, char *argv[])>
+
+Reads the PASM or PBC file from argv[1], loads it, and then calls
+Parrot_debug().
+
+=cut
+
+*/
+
+int
+main(int argc, char *argv[])
+{
+    Parrot_Interp     debugger = Parrot_new(NULL);
+    Parrot_Interp     interp   = Parrot_new(debugger);
+    PDB_t            *pdb      = mem_allocate_zeroed_typed(PDB_t);
+    const char       *filename;
+    char             *ext;
+    void             *yyscanner;
+
+    /*Parrot_set_config_hash();  TODO link with cfg */
+
+    /* attach pdb structure */
+    debugger->pdb    = pdb;
+    interp->debugger = debugger;
+    pdb->debugee     = interp;
+
+    Parrot_block_GC_mark(interp);
+    Parrot_block_GC_sweep(interp);
+
+    do_yylex_init(interp, &yyscanner);
+
+    if (argc < 2) {
+        fprintf(stderr, "Usage: parrot_debugger programfile [program-options]\n");
+        Parrot_exit(interp, 1);
+    }
+
+    filename = argv[1];
+    ext      = strrchr(filename, '.');
+
+    if (ext && STREQ(ext, ".pbc")) {
+        Parrot_PackFile pf = Parrot_readbc(interp, filename);
+
+        if (!pf)
+            return 1;
+
+        Parrot_loadbc(interp, pf);
+    }
+    else {
+        Parrot_PackFile pf        = PackFile_new(interp, 0);
+        int             pasm_file = 0;
+
+        Parrot_loadbc(interp, pf);
+
+        IMCC_push_parser_state(interp);
+        IMCC_INFO(interp)->state->file = filename;
+
+        if (!(imc_yyin_set(fopen(filename, "r"), yyscanner)))    {
+            IMCC_fatal_standalone(interp, E_IOError,
+                    "Error reading source file %s.\n",
+                    filename);
+        }
+
+        if (ext && STREQ(ext, ".pasm"))
+            pasm_file = 1;
+
+        emit_open(interp, 1, NULL);
+        IMCC_INFO(interp)->state->pasm_file = pasm_file;
+        yyparse(yyscanner, interp);
+        imc_compile_all_units(interp);
+
+        imc_cleanup(interp, yyscanner);
+
+        fclose(imc_yyin_get(yyscanner));
+        PackFile_fixup_subs(interp, PBC_POSTCOMP, NULL);
+    }
+
+    Parrot_unblock_GC_mark(interp);
+    Parrot_unblock_GC_sweep(interp);
+
+    PDB_printwelcome();
+
+    PDB_run_code(interp, argc - 1, argv + 1);
+
+
+    Parrot_exit(interp, 0);
+}
+
+/*
+
+=item C<static void PDB_add_exception_handler(Parrot_Interp)>
+
+Adds a default exception handler to PDB.
+
+*/
+
+static void
+PDB_run_code(Parrot_Interp interp, int argc, char *argv[])
+{
+    Parrot_exception exp;
+
+    if (setjmp(exp.destination)) {
+        char *msg = string_to_cstring(interp, interp->exceptions->msg);
+        fprintf(stderr, "Caught exception: %s\n", msg);
+        string_cstring_free(msg);
+        return;
+    }
+
+    push_new_c_exception_handler(interp, &exp);
+
+    Parrot_runcode(interp, argc - 1, argv + 1);
+}
+
+/*
+
+=item C<static void PDB_printwelcome(void)>
+
+Prints out the welcome string.
+
+=cut
+
+*/
+
+static void
+PDB_printwelcome(void)
+{
+    fprintf(stderr, "Parrot Debugger 0.4.x\n");
+    fprintf(stderr, "\nPlease note: ");
+    fprintf(stderr, "the debugger is currently under reconstruction\n");
+}
+
+/*
+
+=back
+
+=head1 SEE ALSO
+
+F<src/debug.c>, F<include/parrot/debug.h>.
+
+=head1 HISTORY
+
+=over 4
+
+=item * Initial version by Daniel Grunblatt on 2002.5.19.
+
+=item * Start of rewrite - leo 2005.02.16
+
+The debugger now uses it's own interpreter. User code is run in
+Interp* debugee. We have:
+
+  debug_interp->pdb->debugee->debugger
+    ^                            |
+    |                            v
+    +------------- := -----------+
+
+Debug commands are mostly run inside the C<debugger>. User code
+runs of course in the C<debugee>.
+
+=back
+
+=head1 TODO
+
+=over 4
+
+=item * Check the user input for bad commands, it's quite easy to make
+it bang now, try listing the source before loading or disassembling it.
+
+=item * Print the interpreter info.
+
+=item * Make the user interface better (add comands
+history/completion).
+
+=item * Some other things I don't remember now because it's late.
+
+
+=back
+
+=cut
+
+*/
+
+
+/*
+ * Local variables:
+ *   c-file-style: "parrot"
+ * End:
+ * vim: expandtab shiftwidth=4:
+ */
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/src/pdb.c src/parrot-0.6.4/src/pdb.c
--- origsrc/parrot-0.6.4/src/pdb.c	2008-07-03 06:49:25.000000000 +0000
+++ src/parrot-0.6.4/src/pdb.c	1970-01-01 00:00:00.000000000 +0000
@@ -1,304 +0,0 @@
-/*
-Copyright (C) 2001-2008, The Perl Foundation.
-$Id: pdb.c 28973 2008-07-02 21:28:26Z chromatic $
-
-=head1 NAME
-
-pdb - The Parrot debugger
-
-=head1 SYNOPSIS
-
- pdb programfile
-
-=head1 DESCRIPTION
-
-=head2 Commands
-
-=over 4
-
-=item C<disassemble>
-
-Disassemble the bytecode.
-
-Use this if you have a PBC file but not the PASM.
-
-=item C<load>
-
-Load a source code file.
-
-=item C<list> or C<l>
-
-List the source code file.
-
-=item C<run> or C<r>
-
-Run the program.
-
-=item C<break> or C<b>
-
-Add a breakpoint.
-
-=item C<watch> or C<w>
-
-Add a watchpoint.
-
-=item C<delete> or C<d>
-
-Delete a breakpoint.
-
-=item C<disable>
-
-Disable a breakpoint.
-
-=item C<enable>
-
-Reenable a disabled breakpoint.
-
-=item C<continue> or C<c>
-
-Continue the program execution.
-
-=item C<next> or C<n>
-
-Run the next instruction
-
-=item C<eval> or C<e>
-
-Run an instruction.
-
-=item C<trace> or C<t>
-
-Trace the next instruction.
-
-=item C<print> or C<p>
-
-Print the interpreter registers.
-
-=item C<stack> or C<s>
-
-Examine the stack.
-
-=item C<info>
-
-Print interpreter information.
-
-=item C<quit> or C<q>
-
-Exit the debugger.
-
-=item C<help> or C<h>
-
-Print the help.
-
-=back
-
-=head2 Debug Ops
-
-You can also debug Parrot code by using the C<debug_init>, C<debug_load>
-and C<debug_break> ops in F<ops/debug.ops>.
-
-=over 4
-
-=cut
-
-*/
-
-#include <stdio.h>
-#include <stdlib.h>
-#include <ctype.h>
-#include "../compilers/imcc/imc.h"
-#include "../compilers/imcc/parser.h"
-#include "parrot/embed.h"
-
-static void PDB_printwelcome(void);
-static void PDB_run_code(Parrot_Interp interp, int argc, char *argv[]);
-
-/*
-
-=item C<int main(int argc, char *argv[])>
-
-Reads the PASM or PBC file from argv[1], loads it, and then calls
-Parrot_debug().
-
-=cut
-
-*/
-
-int
-main(int argc, char *argv[])
-{
-    Parrot_Interp     debugger = Parrot_new(NULL);
-    Parrot_Interp     interp   = Parrot_new(debugger);
-    PDB_t            *pdb      = mem_allocate_zeroed_typed(PDB_t);
-    const char       *filename;
-    char             *ext;
-    void             *yyscanner;
-
-    /*Parrot_set_config_hash();  TODO link with cfg */
-
-    /* attach pdb structure */
-    debugger->pdb    = pdb;
-    interp->debugger = debugger;
-    pdb->debugee     = interp;
-
-    Parrot_block_GC_mark(interp);
-    Parrot_block_GC_sweep(interp);
-
-    do_yylex_init(interp, &yyscanner);
-
-    if (argc < 2) {
-        fprintf(stderr, "Usage: pdb programfile [program-options]\n");
-        Parrot_exit(interp, 1);
-    }
-
-    filename = argv[1];
-    ext      = strrchr(filename, '.');
-
-    if (ext && STREQ(ext, ".pbc")) {
-        Parrot_PackFile pf = Parrot_readbc(interp, filename);
-
-        if (!pf)
-            return 1;
-
-        Parrot_loadbc(interp, pf);
-    }
-    else {
-        Parrot_PackFile pf        = PackFile_new(interp, 0);
-        int             pasm_file = 0;
-
-        Parrot_loadbc(interp, pf);
-
-        IMCC_push_parser_state(interp);
-        IMCC_INFO(interp)->state->file = filename;
-
-        if (!(imc_yyin_set(fopen(filename, "r"), yyscanner)))    {
-            IMCC_fatal_standalone(interp, E_IOError,
-                    "Error reading source file %s.\n",
-                    filename);
-        }
-
-        if (ext && STREQ(ext, ".pasm"))
-            pasm_file = 1;
-
-        emit_open(interp, 1, NULL);
-        IMCC_INFO(interp)->state->pasm_file = pasm_file;
-        yyparse(yyscanner, interp);
-        imc_compile_all_units(interp);
-
-        imc_cleanup(interp, yyscanner);
-
-        fclose(imc_yyin_get(yyscanner));
-        PackFile_fixup_subs(interp, PBC_POSTCOMP, NULL);
-    }
-
-    Parrot_unblock_GC_mark(interp);
-    Parrot_unblock_GC_sweep(interp);
-
-    PDB_printwelcome();
-
-    PDB_run_code(interp, argc - 1, argv + 1);
-
-
-    Parrot_exit(interp, 0);
-}
-
-/*
-
-=item C<static void PDB_add_exception_handler(Parrot_Interp)>
-
-Adds a default exception handler to PDB.
-
-*/
-
-static void
-PDB_run_code(Parrot_Interp interp, int argc, char *argv[])
-{
-    Parrot_exception exp;
-
-    if (setjmp(exp.destination)) {
-        char *msg = string_to_cstring(interp, interp->exceptions->msg);
-        fprintf(stderr, "Caught exception: %s\n", msg);
-        string_cstring_free(msg);
-        return;
-    }
-
-    push_new_c_exception_handler(interp, &exp);
-
-    Parrot_runcode(interp, argc - 1, argv + 1);
-}
-
-/*
-
-=item C<static void PDB_printwelcome(void)>
-
-Prints out the welcome string.
-
-=cut
-
-*/
-
-static void
-PDB_printwelcome(void)
-{
-    fprintf(stderr, "Parrot Debugger 0.4.x\n");
-    fprintf(stderr, "\nPlease note: ");
-    fprintf(stderr, "the debugger is currently under reconstruction\n");
-}
-
-/*
-
-=back
-
-=head1 SEE ALSO
-
-F<src/debug.c>, F<include/parrot/debug.h>.
-
-=head1 HISTORY
-
-=over 4
-
-=item * Initial version by Daniel Grunblatt on 2002.5.19.
-
-=item * Start of rewrite - leo 2005.02.16
-
-The debugger now uses it's own interpreter. User code is run in
-Interp* debugee. We have:
-
-  debug_interp->pdb->debugee->debugger
-    ^                            |
-    |                            v
-    +------------- := -----------+
-
-Debug commands are mostly run inside the C<debugger>. User code
-runs of course in the C<debugee>.
-
-=back
-
-=head1 TODO
-
-=over 4
-
-=item * Check the user input for bad commands, it's quite easy to make
-it bang now, try listing the source before loading or disassembling it.
-
-=item * Print the interpreter info.
-
-=item * Make the user interface better (add comands
-history/completion).
-
-=item * Some other things I don't remember now because it's late.
-
-
-=back
-
-=cut
-
-*/
-
-
-/*
- * Local variables:
- *   c-file-style: "parrot"
- * End:
- * vim: expandtab shiftwidth=4:
- */
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/t/tools/parrot_debugger.t src/parrot-0.6.4/t/tools/parrot_debugger.t
--- origsrc/parrot-0.6.4/t/tools/parrot_debugger.t	1970-01-01 00:00:00.000000000 +0000
+++ src/parrot-0.6.4/t/tools/parrot_debugger.t	2008-07-19 08:18:54.671875000 +0000
@@ -0,0 +1,122 @@
+#! perl
+# Copyright (C) 2007, The Perl Foundation.
+# $Id: parrot_debugger.t 21449 2007-09-21 09:32:00Z paultcochrane $
+
+=head1 NAME
+
+t/tools/parrot_debugger.t - test the Parrot Debugger
+
+=head1 SYNOPSIS
+
+    % prove t/tools/parrot_debugger.t
+
+
+=head1 DESCRIPTION
+
+Tests the C<parrot_debugger> tool by providing it with a number of source files,
+and running through it with various commands.
+
+We never actually check the *full* output of parrot_debugger.  We simply check
+several smaller components to avoid a test file that is far too unwieldy.
+
+
+=head1 REQUIREMENTS
+
+This test script requires you to build parrot_debugger, by typing "make
+parrot_debugger" (using a suitable make tool for your platform).  If this
+requirement has not been met, all tests will be skipped.
+
+=cut
+
+use strict;
+use warnings;
+use lib qw(lib);
+
+use Test::More;
+use IO::File;
+use Parrot::Config;
+use File::Spec;
+
+my $path_to_pdb;
+
+BEGIN {
+    $path_to_pdb = File::Spec->catfile( ".", "pdb" );
+    my $exefile = $path_to_pdb . $PConfig{exe};
+    unless ( -f $exefile ) {
+        plan skip_all => "pdb hasn't been built";
+        exit(0);
+    }
+}
+
+my $tests = 0;
+
+ok( pdb_output_like( <<PIR, "pir", "help", 'List of commands:' ), "help page" );
+.sub main :main
+    \$N3 = 3.14159
+    print \$N3
+    print "\\n"
+.end
+PIR
+ok( pdb_output_like( <<PIR, "pir", "r", '3\.14159' ), "running the program" );
+.sub main :main
+    \$N3 = 3.14159
+    print \$N3
+    print "\\n"
+.end
+PIR
+BEGIN { $tests += 2 }
+
+BEGIN { plan tests => $tests; }
+
+=head1 HELPER SUBROUTINES
+
+=head2 pdb_output_like
+
+    ok(pdb_output_like(<<PASM, "pasm", 'r', "some output"), "running $file");
+
+Takes 4 arguments: a file to run, the filename-extension of the file
+(probably "pir" or "pasm"), the command or commands to provide to pdb as
+input, and a regex string to match within pdb's output.
+
+=cut
+
+my $testno = 0;
+
+sub pdb_output_like {
+    my ( $file, $ext, $input, $check ) = @_;
+    $testno++;
+    my $codefn   = "$0.$testno.$ext";
+    my $stdinfn  = "$0.$testno.stdin";
+    my $stdoutfn = "$0.$testno.stdout";
+    my $f        = IO::File->new(">$codefn");
+    $f->print($file);
+    $f->close();
+    $f = IO::File->new(">$stdinfn");
+    $f->print($input);
+    $f->print("\nquit\n");
+    $f->close();
+    system("$path_to_pdb $codefn <$stdinfn >$stdoutfn 2>&1");
+    $f = IO::File->new($stdoutfn);
+    my $output = join( "", <$f> );
+    return $output =~ /$check/;
+}
+
+=head1 TODO
+
+=over 4
+
+=item
+
+Flesh it out.  This is a bare bones proof of concept.  Add tests for all of the
+commands.
+
+=back
+
+=cut
+
+# Local Variables:
+#   mode: cperl
+#   cperl-indent-level: 4
+#   fill-column: 80
+# End:
+# vim: expandtab shiftwidth=4:
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/t/tools/pdb.t src/parrot-0.6.4/t/tools/pdb.t
--- origsrc/parrot-0.6.4/t/tools/pdb.t	2008-02-23 18:27:29.000000000 +0000
+++ src/parrot-0.6.4/t/tools/pdb.t	1970-01-01 00:00:00.000000000 +0000
@@ -1,123 +0,0 @@
-#! perl
-# Copyright (C) 2007, The Perl Foundation.
-# $Id: pdb.t 21449 2007-09-21 09:32:00Z paultcochrane $
-
-=head1 NAME
-
-t/tools/pdb.t - test the Parrot Debugger
-
-=head1 SYNOPSIS
-
-    % prove t/tools/pdb.t
-
-
-=head1 DESCRIPTION
-
-Tests the C<pdb> tool by providing it with a number of source files,
-and running through it with various commands.
-
-We never actually check the *full* output of pdb.  We simply check
-several smaller components to avoid a test file that is far too
-unwieldy.
-
-
-=head1 REQUIREMENTS
-
-This test script requires you to build pdb, by typing "make pdb" (using
-a suitable make tool for your platform).  If this requirement has not
-been met, all tests will be skipped.
-
-=cut
-
-use strict;
-use warnings;
-use lib qw(lib);
-
-use Test::More;
-use IO::File;
-use Parrot::Config;
-use File::Spec;
-
-my $path_to_pdb;
-
-BEGIN {
-    $path_to_pdb = File::Spec->catfile( ".", "pdb" );
-    my $exefile = $path_to_pdb . $PConfig{exe};
-    unless ( -f $exefile ) {
-        plan skip_all => "pdb hasn't been built";
-        exit(0);
-    }
-}
-
-my $tests = 0;
-
-ok( pdb_output_like( <<PIR, "pir", "help", 'List of commands:' ), "help page" );
-.sub main :main
-    \$N3 = 3.14159
-    print \$N3
-    print "\\n"
-.end
-PIR
-ok( pdb_output_like( <<PIR, "pir", "r", '3\.14159' ), "running the program" );
-.sub main :main
-    \$N3 = 3.14159
-    print \$N3
-    print "\\n"
-.end
-PIR
-BEGIN { $tests += 2 }
-
-BEGIN { plan tests => $tests; }
-
-=head1 HELPER SUBROUTINES
-
-=head2 pdb_output_like
-
-    ok(pdb_output_like(<<PASM, "pasm", 'r', "some output"), "running $file");
-
-Takes 4 arguments: a file to run, the filename-extension of the file
-(probably "pir" or "pasm"), the command or commands to provide to pdb as
-input, and a regex string to match within pdb's output.
-
-=cut
-
-my $testno = 0;
-
-sub pdb_output_like {
-    my ( $file, $ext, $input, $check ) = @_;
-    $testno++;
-    my $codefn   = "$0.$testno.$ext";
-    my $stdinfn  = "$0.$testno.stdin";
-    my $stdoutfn = "$0.$testno.stdout";
-    my $f        = IO::File->new(">$codefn");
-    $f->print($file);
-    $f->close();
-    $f = IO::File->new(">$stdinfn");
-    $f->print($input);
-    $f->print("\nquit\n");
-    $f->close();
-    system("$path_to_pdb $codefn <$stdinfn >$stdoutfn 2>&1");
-    $f = IO::File->new($stdoutfn);
-    my $output = join( "", <$f> );
-    return $output =~ /$check/;
-}
-
-=head1 TODO
-
-=over 4
-
-=item
-
-Flesh it out.  This is a bare bones proof of concept.  Add tests for all of the
-commands.
-
-=back
-
-=cut
-
-# Local Variables:
-#   mode: cperl
-#   cperl-indent-level: 4
-#   fill-column: 100
-# End:
-# vim: expandtab shiftwidth=4:
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/tools/dev/install_files.pl src/parrot-0.6.4/tools/dev/install_files.pl
--- origsrc/parrot-0.6.4/tools/dev/install_files.pl	2008-05-11 12:57:40.000000000 +0000
+++ src/parrot-0.6.4/tools/dev/install_files.pl	2008-07-19 08:18:54.671875000 +0000
@@ -126,7 +126,7 @@
     bindir      => '/usr/bin',
     libdir      => '/usr/lib',
     includedir  => '/usr/include',
-    docdir      => '/usr/share/doc',
+    docdir      => '/usr/share/doc/parrot',
     'dry-run'   => 0,
 );
 
@@ -189,6 +189,7 @@
     }
     elsif ( $meta{include} ) {
         $dest =~ s/^include//;
+        $dest =~ s/^src/parrot/;
         $dest = File::Spec->catdir( $options{includedir}, $dest );
     }
     elsif ( $meta{doc} ) {
@@ -197,13 +198,16 @@
     elsif ( $meta{pkgconfig} ) {
 
         # For the time being this is hardcoded as being installed under libdir
-        # as it is typically donw with automake installed packages.  If there
+        # as it is typically done with automake installed packages.  If there
         # is a use case to make this configurable we'll add a seperate
         # --pkgconfigdir option.
         $dest = File::Spec->catdir( $options{libdir}, 'pkgconfig', $dest );
     }
     else {
-        $dest =~ s/^runtime/lib/ if /\[library]/;
+        $dest =~ s|^runtime/|lib/|; # if /\[library]/;
+        # $dest =~ s|^src/|src/parrot/|;
+        $dest =~ s|^src/|lib/parrot/src/|;
+	next if $dest =~ /compilers|config|language|tools/;
         $dest = File::Spec->catdir( $options{prefix}, $dest );
     }
 
@@ -243,6 +247,7 @@
     }
     else {
         next unless -e $src;
+        next if $^O eq 'cygwin' and -e "$src.exe"; # cygwin stat works, but copy not
         copy( $src, $dest ) or die "copy $src to $dest: $!\n";
         print "$dest\n";
     }
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x 'README~' -x 'parrot-0.6.4-1.cygport~' -x 'parrot-0.6.4-1.src.patch~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in -x 'MANIFEST.*' -x parrot.pc -x myconfig -x config_lib.pasm -x Makefile -x TAGS origsrc/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl src/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl
--- origsrc/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl	2008-06-30 09:34:12.000000000 +0000
+++ src/parrot-0.6.4/tools/dev/pbc_to_exe_gen.pl	2008-07-19 08:18:54.671875000 +0000
@@ -361,6 +361,8 @@
     link .= objfile
     link .= pathquote
     link .= ' '
+    link .= config
+    link .= ' '
     link .= rpath
     link .= ' '
     link .= libparrot
@@ -372,8 +374,6 @@
     link .= libs
     link .= ' '
     link .= icushared
-    link .= ' '
-    link .= config
 
     say link
     .local int status
